<!DOCTYPE html>
{% load static %}
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Panel Admin{% endblock %}</title>

  <link href="https://cdnjs.cloudflare.com/ajax/libs/boxicons/2.1.4/css/boxicons.min.css" rel="stylesheet" />
  <link rel="icon" href="{% static 'imagenes/logo.png' %}" type="image/png">

  <style>
    :root{
      --bg:#f5f9ff;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --brand:#2563eb;
      --brand-2:#1d4ed8;
      --border:#e2e8f0;
      --sidebar:#0b1220;
      --sidebar-text:#cbd5e1;
      --sidebar-active:#111a2e;
      --success:#16a34a;
      --warn:#f59e0b;
      --danger:#ef4444;
      --shadow:0 8px 24px rgba(2,6,23,.08);
      --radius:16px;
    }

    *{margin:0;padding:0;box-sizing:border-box}
    body{background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto}
    a{color:inherit;text-decoration:none}
    .container{display:flex;min-height:100vh}

    /* SIDEBAR */
    .sidebar{
      width:280px;flex:0 0 280px;background:var(--sidebar);color:var(--sidebar-text);
      display:flex;flex-direction:column;position:sticky;top:0;height:100vh;z-index:1020;
      transition:transform .25s ease;
    }
    .sidebar .brand{
      display:flex;align-items:center;gap:.75rem;padding:20px;border-bottom:1px solid #0f172a;
    }
    .brand img{width:36px;height:36px;border-radius:10px}
    .brand strong{color:#e2e8f0;font-size:1.05rem}
    .menu{padding:12px}
    .menu .section{margin-top:14px;margin-bottom:6px;padding:0 10px;font-size:.75rem;text-transform:uppercase;color:#94a3b8;letter-spacing:.08em}
    .menu a.item{
      display:flex;align-items:center;gap:.75rem;padding:12px 14px;border-radius:12px;color:var(--sidebar-text);
      transition:background .2s ease,color .2s ease;
    }
    .menu a.item .bx{font-size:1.2rem;width:1.4rem;text-align:center}
    .menu a.item:hover{background:var(--sidebar-active)}
    .menu a.item.active{background:linear-gradient(135deg,#13203a,#0e162b);color:#fff}

    .sidebar .footer{
      margin-top:auto;padding:14px;border-top:1px solid #0f172a;font-size:.85rem;color:#94a3b8;
    }

    /* OVERLAY (mobile) */
    .overlay{
      position:fixed;
      top:0;
      left:0;
      right:0;
      bottom:0;
      background:rgba(0,0,0,.45);
      z-index:1005;
      display:none;
      pointer-events:none;
    }
    .overlay.active{
      display:block;
      pointer-events:auto;
    }

    /* MAIN */
    .main{flex:1;display:flex;flex-direction:column;min-width:0}
    .navbar{
      position:sticky;top:0;z-index:900;background:var(--card);box-shadow:var(--shadow);
      display:flex;align-items:center;gap:10px;justify-content:space-between;padding:12px 16px;
    }
    .nav-left{display:flex;align-items:center;gap:10px}
    .btn-icon{
      border:1px solid var(--border);background:#fff;padding:10px;border-radius:12px;cursor:pointer;
    }
    .btn-icon .bx{font-size:1.2rem}
    .nav-title{font-weight:700}
    .nav-right{display:flex;align-items:center;gap:10px}
    .avatar{width:36px;height:36px;border-radius:50%;object-fit:cover;border:2px solid var(--border)}
    .badge{font-size:.8rem;background:#eef2ff;color:#1e3a8a;border:1px solid #c7d2fe;padding:6px 10px;border-radius:999px}

    .content{padding:20px;display:grid;gap:18px}

    /* WELCOME CARD */
    .card{
      background:var(--card);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);
    }
    .card.p20{padding:20px}
    .card-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .card-title{font-weight:700}
    .muted{color:var(--muted)}

    /* GRID */
    .grid{display:grid;gap:16px}
    .grid.cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:1200px){.grid.cols-4{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:760px){.grid.cols-3,.grid.cols-4{grid-template-columns:1fr}}
    @media (max-width:768px){
      .overlay.active{display:block}
      .sidebar{position:fixed;left:0;top:0;height:100dvh;z-index:1020;transform:translateX(-100%);width:280px}
      .sidebar.open{transform:translateX(0)}
    }

    /* KPI CARD */
    .kpi{display:flex;align-items:center;gap:12px}
    .kpi .icon{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;background:#eff6ff;border:1px solid #dbeafe}
    .kpi .icon .bx{font-size:1.4rem;color:var(--brand)}
    .kpi .value{font-size:1.3rem;font-weight:800}
    .kpi .label{font-size:.85rem;color:var(--muted)}

    /* TABLE */
    .table{width:100%;border-collapse:separate;border-spacing:0 8px}
    .t-row{background:#fff;border:1px solid var(--border)}
    .t-head th{font-size:.8rem;text-transform:uppercase;letter-spacing:.06em;color:var(--muted);text-align:left;padding:10px}
    .t-cell{padding:12px}
    .chip{font-size:.75rem;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#f8fafc}
    .chip.ok{background:#ecfdf5;border-color:#bbf7d0;color:#166534}
    .chip.warn{background:#fffbeb;border-color:#fde68a;color:#92400e}
    .chip.bad{background:#fef2f2;border-color:#fecaca;color:#991b1b}

    /* BUTTONS */
    .btn{
      display:inline-flex;align-items:center;gap:.5rem;padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:#fff;cursor:pointer
    }
    .btn.primary{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;border:none}
    .btn .bx{font-size:1.1rem}
    .action-bar{display:flex;gap:10px;flex-wrap:wrap}

  </style>

  {% block extra_style %}{% endblock %}
</head>
<body>
  <div class="container">

    {% block sidebar %}
      {% include 'componentesBase/sidebar-admin.html' %}
    {% endblock %}

    <div class="main">
      {% block navbar %}
        {% include "componentesBase/navbar-admin.html" with titulo_nav="Panel Admin" rol_nav="Administrador" %}
      {% endblock %}

      <main class="content">
        {% block content %}{% endblock %}
      </main>
    </div>
    
    <div class="overlay" id="overlay"></div>

  </div>

  {% block extra_scripts %}
  <script>
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');

    function toggleSidebar(force){
      const willOpen = typeof force === 'boolean' ? force : !sidebar.classList.contains('open');
      sidebar.classList.toggle('open', willOpen);
      overlay.classList.toggle('active', willOpen);
    }

    // Cerrar al hacer clic en el overlay
    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) {
        toggleSidebar(false);
      }
    });

    // Cerrar al hacer clic en un enlace del menÃº en mobile
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 768 && sidebar.classList.contains('open')) {
        if (e.target.closest('.sidebar a.item') || e.target.closest('.sidebar a.submenu-item')) {
          toggleSidebar(false);
        }
      }
    });

    // Cerrar con ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && sidebar.classList.contains('open')) {
        toggleSidebar(false);
      }
    });

    // Auto-cerrar sidebar al cambiar a desktop
    window.addEventListener('resize', () => {
      if (window.innerWidth > 768 && sidebar.classList.contains('open')) {
        toggleSidebar(false);
      }
    });
  </script>
  {% endblock %}
</body>
</html>
